<template>
    <!-- Page wrapper  -->
    <!-- ============================================================== -->
    <div class="page">
        <!-- ============================================================== -->
        <!-- Bread crumb and right sidebar toggle -->
        <!-- ============================================================== -->
        <div class="page-breadcrumb">
            <div class="row">
                <div class="col-5 align-self-center">
                    <h4 class="page-title">Posts Table</h4>
                    <div class="d-flex align-items-center">
                        <nav aria-label="breadcrumb">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a href="#">Home</a></li>
                                <li class="breadcrumb-item active" aria-current="page">Library</li>
                            </ol>
                        </nav>
                    </div>
                </div>
                <div class="col-7 align-self-center">
                    <div class="d-flex no-block justify-content-end align-items-center">
                        <div class="m-r-10">
                            <div class="lastmonth"></div>
                        </div>
                        <div class=""><small>NumPosts</small>
                            <h4 class="text-info m-b-0 font-medium">13,515</h4></div>
                    </div>
                </div>
            </div>
        </div>
        <!-- ============================================================== -->
        <!-- End Bread crumb and right sidebar toggle -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- Container fluid  -->
        <!-- ============================================================== -->
        <div class="container-fluid">
            <!-- ============================================================== -->
            <!-- Start Page Content -->
            <!-- ============================================================== -->
            <div class="row">
                <!-- Column -->
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table product-overview" id="zero_config">
                                    <thead>
                                    <tr>
                                        <th>User</th>
                                        <th>ID</th>
                                        <th>Photo</th>
                                        <th>Post</th>
                                        <th>Likes</th>
                                        <th>Date</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <td>Ahmed R. Mohamed</td>
                                        <td>1</td>
                                        <td> <img src="../../../../../public/images/AdminDashboardImages/images/gallery/chair.jpg" alt="iMac" width="80"> </td>
                                        <td>Rounded Chair</td>
                                        <td>20</td>
                                        <td>10-7-2018</td>
                                        <td> <span class="label label-success font-weight-100">Active</span> </td>
                                        <td><a href="javascript:void(0)" class="text-inverse p-r-10" data-toggle="tooltip" title="Edit"><i class="ti-marker-alt"></i></a> <a href="javascript:void(0)" class="text-inverse" title="Delete" data-toggle="tooltip"><i class="ti-trash"></i></a></td>
                                    </tr>
                                    <tr>
                                        <td>Yasser Ibrahim</td>
                                        <td>2</td>
                                        <td> <img src="../../../../../public/images/AdminDashboardImages/images/gallery/chair2.jpg" alt="iPhone" width="80"> </td>
                                        <td>Wooden Chair</td>
                                        <td>25</td>
                                        <td>09-7-2018</td>
                                        <td> <span class="label label-warning font-weight-100">Pending</span> </td>
                                        <td><a href="javascript:void(0)" class="text-inverse p-r-10" data-toggle="tooltip" title="Edit"><i class="ti-marker-alt"></i></a> <a href="javascript:void(0)" class="text-inverse" title="Delete" data-toggle="tooltip"><i class="ti-trash"></i></a></td>
                                    </tr>
                                    <tr>
                                        <td>Mohamed Essam</td>
                                        <td>3</td>
                                        <td> <img src="../../../../../public/images/AdminDashboardImages/images/gallery/chair3.jpg" alt="apple_watch" width="80"> </td>
                                        <td>Gray Chair</td>
                                        <td>12</td>
                                        <td>08-7-2018</td>
                                        <td> <span class="label label-success font-weight-100">Active</span> </td>
                                        <td><a href="javascript:void(0)" class="text-inverse p-r-10" data-toggle="tooltip" title="Edit"><i class="ti-marker-alt"></i></a> <a href="javascript:void(0)" class="text-inverse" title="Delete" data-toggle="tooltip"><i class="ti-trash"></i></a></td>
                                    </tr>
                                    <tr>
                                        <td>Ahmed Gamal</td>
                                        <td>4</td>
                                        <td> <img src="../../../../../public/images/AdminDashboardImages/images/gallery/chair4.jpg" alt="mac_mouse" width="80"> </td>
                                        <td>Wooden chair</td>
                                        <td>1</td>
                                        <td>02-7-2018</td>
                                        <td> <span class="label label-danger font-weight-100">Blocked</span> </td>
                                        <td><a href="javascript:void(0)" class="text-inverse p-r-10" data-toggle="tooltip" title="Edit"><i class="ti-marker-alt"></i></a> <a href="javascript:void(0)" class="text-inverse" title="Delete" data-toggle="tooltip"><i class="ti-trash"></i></a></td>
                                    </tr>
                                    <tr>
                                        <td>Mazen Emad</td>
                                        <td>5</td>
                                        <td> <img src="../../../../../public/images/AdminDashboardImages/images/gallery/chair.jpg" alt="iMac" width="80"> </td>
                                        <td>Rounded Chair</td>
                                        <td>100</td>
                                        <td>08-7-2018</td>
                                        <td> <span class="label label-success font-weight-100">Active</span> </td>
                                        <td><a href="javascript:void(0)" class="text-inverse p-r-10" data-toggle="tooltip" title="Edit"><i class="ti-marker-alt"></i></a> <a href="javascript:void(0)" class="text-inverse" title="Delete" data-toggle="tooltip"><i class="ti-trash"></i></a></td>
                                    </tr>
                                    <tr>
                                        <td>Gamal Ahmed</td>
                                        <td>10</td>
                                        <td> <img src="../../../../../public/images/AdminDashboardImages/images/gallery/chair2.jpg" alt="iPhone" width="80"> </td>
                                        <td>Wooden Chair</td>
                                        <td>14</td>
                                        <td>06-7-2018</td>
                                        <td> <span class="label label-warning font-weight-100">Pending</span> </td>
                                        <td><a href="javascript:void(0)" class="text-inverse p-r-10" data-toggle="tooltip" title="Edit"><i class="ti-marker-alt"></i></a> <a href="javascript:void(0)" class="text-inverse" title="Delete" data-toggle="tooltip"><i class="ti-trash"></i></a></td>
                                    </tr>
                                    <tr>
                                        <td>Ezat Essam</td>
                                        <td>6</td>
                                        <td> <img src="../../../../../public/images/AdminDashboardImages/images/gallery/chair.jpg" alt="apple_watch" width="80"> </td>
                                        <td>Still Gray Chair</td>
                                        <td>11</td>
                                        <td>05-7-2018</td>
                                        <td> <span class="label label-success font-weight-100">Active</span> </td>
                                        <td><a href="javascript:void(0)" class="text-inverse p-r-10" data-toggle="tooltip" title="Edit"><i class="ti-marker-alt"></i></a> <a href="javascript:void(0)" class="text-inverse" title="Delete" data-toggle="tooltip"><i class="ti-trash"></i></a></td>
                                    </tr>
                                    <tr>
                                        <td>Hagar Ali</td>
                                        <td>7</td>
                                        <td> <img src="../../../../../public/images/AdminDashboardImages/images/gallery/chair4.jpg" alt="mac_mouse" width="80"> </td>
                                        <td>wooden chair</td>
                                        <td>28</td>
                                        <td>01-7-2018</td>
                                        <td> <span class="label label-danger font-weight-100">Blocked</span> </td>
                                        <td><a href="javascript:void(0)" class="text-inverse p-r-10" data-toggle="tooltip" title="Edit"><i class="ti-marker-alt"></i></a> <a href="javascript:void(0)" class="text-inverse" title="Delete" data-toggle="tooltip"><i class="ti-trash"></i></a></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Column -->
            </div>
            <!-- ============================================================== -->
            <!-- End Page Content -->
            <!-- ============================================================== -->
        </div>
        <!-- ============================================================== -->
        <!-- End Container fluid  -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- footer -->
        <!-- ============================================================== -->
        <footer class="footer text-center">
            Ahmed R. Mohamed
        </footer>
        <!-- ============================================================== -->
        <!-- End footer -->
        <!-- ============================================================== -->
    </div>
    <!-- ============================================================== -->
    <!-- End Page wrapper  -->
    <!-- ============================================================== -->
</template>

<script>
    export default {
        props: {},
        data() {
            return {
                items: [],
                fields: [
                    {key: 'index', label: '#', sortable: true, sortDirection: 'desc'},
                    {key: 'name', label: 'Name', sortable: true, sortDirection: 'desc'},
                    {key: 'email', label: 'Email', sortable: true, class: 'text-center'},
                    {key: 'phone', label: 'Phone', sortable: true, sortDirection: 'desc'},
                    {key: 'type', label: 'Role', sortable: true, sortDirection: 'desc'},
                    {key: 'age', label: 'Age', sortable: true, sortDirection: 'desc'},
                    {key: 'created_at', label: 'Joining Date', sortable: true, sortDirection: 'desc'},
                    {key: 'posts', label: 'Posts', sortable: true, sortDirection: 'desc'},
                    {key: 'actions', label: 'Actions'},
                ],
                totalRows: 1,
                currentPage: 1,
                perPage: 20,
                pageOptions: [10, 25, 50, 100],
                sortBy: null,
                sortDesc: false,
                sortDirection: 'asc',
                filter: null,
                //DB
                users: [],
                user: {},
                newUser: {
                    name: '',
                    email: '',
                    password: '',
                    type: '',
                },
                user_id: 0,
                image_src: '../../../../../public/images/AdminDashboardImages/images/users/1.jpg',
            }
        },
        mounted: function () {
            console.log('Component fired.');
            this.totalRows = this.users.length;
        },
        computed: {
            sortOptions() {
                // Create an options list from our fields
                return this.fields
                    .filter(f => f.sortable)
                    .map(f => {
                        return {text: f.label, value: f.key}
                    })
            }
        },

        created: function () {
            this.fetchUsers();
        },
        methods: {
            fetchUsers: function () {
                axios.get('../api/admin-dashboard/users').then(response => {
                    this.users = response.data.users;
                    this.totalRows = this.users.length;
                    // console.log("************* This.users *****************");
                    // console.log(this.users);
                    // console.log(JSON.stringify(this.users[0]));
                });
            },
            storeUser: function () {
                axios.post('../api/admin-dashboard/users', this.newUser).then(response => {
                    this.newUser = response.data.newUser;
                    this.users.push(this.newUser);
                    // $('.CloseAddUserForm').click();
                }).catch(error => {
                    console.log(error);
                })
            },
            destroyUser: function (id, index) {
                axios.delete('/api/admin-dashboard/users/' + id).then(response => {
                    this.newUser = response.data.user;
                    this.users.splice(index, 1);
                }).catch(error => {
                    console.log(error);
                })
            },
            // To Show the user information in the modal
            EditUser: function (id) {
                axios.get('/api/admin-dashboard/users/' + id + '/edit').then(response => {
                    this.user = response.data.user;
                }).catch(error => {
                    console.log(error);
                })
            },
            resetUser: function () {
                console.log(this.user);
            },
            updateUser: function (id, user) {
                console.log(user);
                axios.patch('/api/admin-dashboard/users/' + id, user).then(response => {
                    this.user = response.data.user;
                    this.fetchUsers();
                    console.log(this.user);
                }).catch(error => {
                    console.log(error);
                })
            },
            onFiltered(filteredItems) {
                // Trigger pagination to update the number of buttons/pages due to filtering
                this.totalRows = filteredItems.length;
                this.currentPage = 1;
            }
        },
    }
</script>
<style scoped>
    .delete-alert {
        /*background-color: red;*/
        position: absolute;
        z-index: 1;
        top: 20%;
        left: 25%;
    }

    .alert-head {
        padding-bottom: 20px;
        padding-top: 10px;
        border-bottom: 1px solid #cccccc;
    }

    .alert-body {
        padding: 20px 0 10px 0;
        border-bottom: 1px solid #cccccc;
    }

    .alert-footer {
        padding: 20px 0;
        float: right;
    }

    table tr td span {
        text-transform: capitalize;
    }

    .btn-pure {
        background-color: transparent;
        color: #000;
        border: 0;
    }
</style>
